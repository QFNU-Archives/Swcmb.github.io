<!DOCTYPE html><html lang="cn" theme-mode="auto"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>前缀和与差分算法 | Ianwusb's Blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","search":{"preload":"all","activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light' || window.matchMedia('(prefers-color-scheme:light)').matches)
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark' || window.matchMedia('(prefers-color-scheme:dark)').matches)
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>:root {
 --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
 --light-background: url('/img/bk.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="https://ianwusb.blog/project"><span class="navItemTitle">Project</span></a></li><li class="navItem"><a class="navBlock" href="/Live/"><span class="navItemTitle">Living</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>前缀和与差分算法</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2024-04-10T12:56:08.000Z" id="date"> 2024-04-10</time></div></span><br><span>Last Update: <div class="control"><time datetime="2024-04-11T07:33:45.632Z" id="updated"> 2024-04-11</time></div></span><br><span>Word Count: <div class="control">1.8k</div></span><br><span>Read Time: <div class="control">7 min</div></span></div></div><hr><div id="post-content"><h2 id="前缀和算法-prefix-sum"><a href="#前缀和算法-prefix-sum" class="headerlink" title="前缀和算法(prefix sum)"></a>前缀和算法(prefix sum)</h2><p>前缀和是一种简单的有效的优化算法，能把计算复杂度为O(n)的区间计算优化为O(1)的端点计算</p>
<h2 id="前缀和的概念"><a href="#前缀和的概念" class="headerlink" title="前缀和的概念"></a>前缀和的概念</h2><p>一个长度为n的数组a[1]<del>a[n]，前缀和sum[i]等于a[1]</del>a[i]的和：</p>
<p>sum[i]&#x3D;a[1]+a[2]+…+a[i]</p>
<p>利用递推，可以在O(n)时间内求得所有前缀和：</p>
<p>sum[i]&#x3D;sum[i-1]+a[i]</p>
<p>如果预计算出前缀和，就能利用它快速计算出数组中任意一个区间a[i]~a[j]的和，即：</p>
<p>a[i]+a[i+1]+…+a[j-1]+a[j]&#x3D;sum[j]-sum[j-1]</p>
<p>上式说明，复杂度为O(n)的区间求和计算，优化到了O(1)的前缀和计算</p>
<h2 id="前缀和例题"><a href="#前缀和例题" class="headerlink" title="前缀和例题"></a>前缀和例题</h2><p><strong>如果建模时发现有区间求和操作，可以考虑使用前缀和优化</strong></p>
<h2 id="例一-0求和-蓝桥云课-lanqiao-cn"><a href="#例一-0求和-蓝桥云课-lanqiao-cn" class="headerlink" title="例一  0求和 - 蓝桥云课 (lanqiao.cn)"></a>例一  <a target="_blank" rel="noopener" href="https://www.lanqiao.cn/problems/2080/learning/">0求和 - 蓝桥云课 (lanqiao.cn)</a></h2><p>将给定的计算式子变换为：</p>
<p>$$<br>S &#x3D; (a_1 + a_2 + \ldots + a_{n-1}) \times a_n + (a_1 + a_2 + \ldots + a_{n-2}) \times a_{n-1} + (a_1 + a_2 + ldots + a_{n-3}) \times a_{n-2} + \ldots + (a_1 + a_2) \times a_3 + a_1 \times a_2<br>$$</p>
<p>其中括号内的部分是前缀和<br>$$<br> sum[i] &#x3D; a_1 + a_2 + \ldots + a_i<br>$$<br>，把上式改写为：</p>
<p>$$<br>S &#x3D; sum[n - 1] \times a_n + sum[n - 2] \times a_{n-1} + sum[n - 3] \times a_{n-2} + \ldots + sum[2] \times a_3 + sum[1] times a_2<br>$$</p>
<p>式子中用到的前缀和 sum[1] ~ sum[n-1]，用递推公式 sum[i] &#x3D; sum[i-1] + a[i]做一次for循环就能全部提前计算出来。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 一个长度为n的数组a[1]~a[n]，前缀和sum[i]等于a[1]~a[i]的和：</span>
<span class="token comment"># sum[i]=a[1]+a[2]+...+a[i]</span>
<span class="token comment"># 利用递推，可以在O(n)时间内求得所有前缀和：</span>
<span class="token comment"># sum[i]=sum[i-1]+a[i]</span>
<span class="token comment"># 如果预计算出前缀和，就能利用它快速计算出数组中任意一个区间a[i]~a[j]的和，即：</span>
<span class="token comment"># a[i]+a[i+1]+...+a[j-1]+a[j]=sum[j]-sum[j-1]</span>
<span class="token comment"># 上式说明，复杂度为O(n)的区间求和计算，优化到了O(1)的前缀和计算</span>

n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token comment">#读入a[1]~a[n]。a[0]不用</span>
<span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#定义前缀和-->[0, 0, 0, 0, 0, 0, 0]</span>
<span class="token builtin">sum</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">sum</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">sum</span><span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment">#预计算前缀和sum[1]~sum[n-1]</span>
s<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">+=</span> <span class="token builtin">sum</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>      <span class="token comment">#计算和s</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="例二-0可获得的最小取值-蓝桥云课-lanqiao-cn"><a href="#例二-0可获得的最小取值-蓝桥云课-lanqiao-cn" class="headerlink" title="例二  0可获得的最小取值 - 蓝桥云课 (lanqiao.cn)"></a>例二  <a target="_blank" rel="noopener" href="https://www.lanqiao.cn/problems/3142/learning/">0可获得的最小取值 - 蓝桥云课 (lanqiao.cn)</a></h2><p>第一步肯定是排序，例如从小到大排序，然后再进行两种操作。操作（1）在<code>a[]</code>的尾部选一个数，操作（2）在<code>a[]</code>的头部选2个数。</p>
<p>容易想到一种简单方法：每次在操作（1）和操作（2）中选较小的值。这是贪心法的思路。但是贪心法对吗？分析之后发现贪心法是错误的，例如{3, 1, 1, 1, 1, 1, 1}，做<code>k=3</code>次操作，每次都按贪心法，做3次操作（2），结果是6。但是正确答案是做3次操作（1），结果是5。</p>
<p>回头重新考虑所有可能的情况。设操作（2）做<code>p</code>次，操作（1）做<code>k-p</code>次，求和：</p>
<p>$$<br>\sum_{i&#x3D;1}^{2p} a_i + \sum_{i&#x3D;n+p-k+1}^{n} a_i<br>$$</p>
<p>为了找最小的和，需要把所有的<code>p</code>都试一遍。如果直接按上面的公式计算，那么验证一个<code>p</code>的计算量是O(n)的，验证所有的<code>p</code>，1≤p≤k，总计算量O(kn)，超时。</p>
<p>容易发现公式的两个部分就是前缀和，分别等于<code>sum[2p]</code>、<code>sum[n] - sum[n+p-k]</code>。如果提前算出前缀和<code>sum[]</code>，那么验证一个<code>p</code>的时间是O(1)的，验证所有<code>p</code>的总计算量是O(n)的。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">n<span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>       <span class="token comment"># a[0]不用，从a[1]开始</span>
s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
    s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
ans <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">**</span><span class="token number">18</span>
<span class="token keyword">for</span> p <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ans <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span>n<span class="token operator">+</span>p<span class="token operator">-</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>p<span class="token punctuation">]</span><span class="token punctuation">,</span> ans<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="例三-二维前缀和"><a href="#例三-二维前缀和" class="headerlink" title="例三 二维前缀和"></a>例三 二维前缀和</h2><p>  前面的例子都是一位数组上的前缀和，下面介绍<strong>二维数组上的前缀和</strong>。<br>例题：<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2004">领地选择</a><br>  概况题意：在n×m 的矩形中找一个边长为c的正方形，把正方形内所有坐标点的值相加，使价值最大。<br>  本题是二维前缀和的直接应用。<br>  一维前缀和定义在一维数组a[]上：sum[i] &#x3D; a[1] + a[2] + … + a[i]<br>  把一维数组a[]看成一条直线上的坐标，前缀和就是所有坐标值的和。<br class='item-img' data-src='https://img-blog.csdnimg.cn/direct/c8624238adc54d5cb0d77c8a97c848ff.png'><img src="https://img-blog.csdnimg.cn/direct/c8624238adc54d5cb0d77c8a97c848ff.png" alt="在这里插入图片描述"></p>
<p>  二维前缀和是一维前缀和的推广。设二维数组a[][]有1<del>n行，1</del>m列，二维前缀和：<br>    sum[i][j] &#x3D; a[1][1]+a[1][2]+a[1][3]+…+a[1][j]<br>        + a[2][1]+a[2][2]+a[2][3]+…+a[2][j]<br>        + …<br>        + a[i][1]+a[i][2]+a[i][3]+…+a[i][j]<br>  把a[i][j]的(i,j)看成二维平面的坐标，那么sum[i][j]就是左下角坐标(1,1)和右上角坐标(i,j)围成的方形中所有坐标点的和。</p>
<p class='item-img' data-src='https://img-blog.csdnimg.cn/direct/4347d57dad2d41f2a2285b124f7d1336.png'><img src="https://img-blog.csdnimg.cn/direct/4347d57dad2d41f2a2285b124f7d1336.png" alt="在这里插入图片描述"><br>  二维前缀和sum[][]存在以下递推关系：<br>  sum[i][j] &#x3D; sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1]+a[i][j]<br>  根据这个递推关系，用两种for循环可以算出sum[][]。<br>  对照上图理解这个公式，sum[i-1][j]是坐标(1,1) ~ (i-1, j)内所有的点，sum[i][j-1]是(1,1) ~ (i, j-1)内所有的点，两者相加，其中sum[i-1][j-1]被加了两次，所以要减去一次。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">n<span class="token punctuation">,</span> m <span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
a<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    a<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> a<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
Max <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'-inf'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token operator">+</span><span class="token number">2</span><span class="token operator">-</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> m<span class="token operator">+</span><span class="token number">2</span><span class="token operator">-</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
        ans <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token operator">+</span>c<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span>c<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> a<span class="token punctuation">[</span>i<span class="token operator">+</span>c<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> a<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span>c<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> ans <span class="token operator">></span> Max<span class="token punctuation">:</span>
            Max <span class="token operator">=</span> ans
            x <span class="token operator">=</span> i
            y <span class="token operator">=</span> j
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="差分算法"><a href="#差分算法" class="headerlink" title="差分算法"></a>差分算法</h1><p>前缀和的主要应用是差分：<strong>差分是前缀和的逆运算</strong>。<br>  与一维数组a[]对应的差分数组d[]的定义：<br>    d[k]&#x3D;a[k]-a[k-1]<br>  即原数组a[]的相邻元素的差。根据d[]的定义，可以推出：<br>    a[k]&#x3D;d[1]+d[2]+…+d[k]<br>  即a[]是d[]的前缀和，所以“差分是前缀和的逆运算”。<br>  为方便理解，把每个a[]看成直线上的坐标。每个d[]看成直线上的小线段，它的两端是相邻的a[]。这些小线段相加，就得到了从起点开始的长线段a[]。<br class='item-img' data-src='https://img-blog.csdnimg.cn/direct/470129757e104b1abc91c3ca77c3a16a.png'><img src="https://img-blog.csdnimg.cn/direct/470129757e104b1abc91c3ca77c3a16a.png" alt="在这里插入图片描述"><br>  差分是一种处理数据的巧妙而简单的方法，它应用于区间的修改和询问问题。把给定的数据元素集A分成很多区间，对这些区间做很多次操作，每次操作是对某个区间内的所有元素做相同的加减操作，若一个个地修改这个区间内的每个元素，非常耗时。引入“差分数组”，当修改某个区间时，只需要修改这个区间的“端点”，就能记录整个区间的修改</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-end"><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2024/04/08/%E5%B8%AE%E6%B4%BE%E5%BC%9F%E4%BD%8D/">帮派弟位 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">ianwusb</a></h1><div id="description"><p>编程魅力在于无尽创造与无限可能，生物魅力深藏于生命奥秘之中</p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/swcmb"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="mailto:z3216243013@163.com"><i class="fa fa-envelope" alt="E-Mail"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BC%80%E5%92%8C%E7%AE%97%E6%B3%95-prefix-sum"><span class="toc-number">1.</span> <span class="toc-text">前缀和算法(prefix sum)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BC%80%E5%92%8C%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">2.</span> <span class="toc-text">前缀和的概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BC%80%E5%92%8C%E4%BE%8B%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text">前缀和例题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E4%B8%80-0%E6%B1%82%E5%92%8C-%E8%93%9D%E6%A1%A5%E4%BA%91%E8%AF%BE-lanqiao-cn"><span class="toc-number">4.</span> <span class="toc-text">例一  0求和 - 蓝桥云课 (lanqiao.cn)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E4%BA%8C-0%E5%8F%AF%E8%8E%B7%E5%BE%97%E7%9A%84%E6%9C%80%E5%B0%8F%E5%8F%96%E5%80%BC-%E8%93%9D%E6%A1%A5%E4%BA%91%E8%AF%BE-lanqiao-cn"><span class="toc-number">5.</span> <span class="toc-text">例二  0可获得的最小取值 - 蓝桥云课 (lanqiao.cn)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E4%B8%89-%E4%BA%8C%E7%BB%B4%E5%89%8D%E7%BC%80%E5%92%8C"><span class="toc-number">6.</span> <span class="toc-text">例三 二维前缀和</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%AE%E5%88%86%E7%AE%97%E6%B3%95"><span class="toc-number"></span> <span class="toc-text">差分算法</span></a></div></div><footer><nobr><span class="icp-title">萌</span><a class="icp-content" target="_blank" rel="noopener" href="https://icp.gov.moe/?keyword=69616e77757362">萌ICP备69616e77757362号</a></nobr><br><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>